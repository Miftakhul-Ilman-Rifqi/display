<!DOCTYPE html>
<html>

<head>
    <title>Google Sheets Data</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <h1>Google Sheets Data</h1>
    <div id="data"></div>

    <script>
        // Replace with your actual API key and spreadsheet ID
        var apiKey = 'AIzaSyAmT4yC_4qq-C_x11d8wRoA18Hnuj29vhs';
        var spreadsheetId = '1IL6KzH6ULJG0ZvPWq52V90F8nfs2EDDwSb0NVd6Ds2E';
        var range = 'A1:G20';

        // Authenticate and authorize using the API key
        function loadClient() {
            gapi.client.setApiKey(apiKey);
            return gapi.client.load('https://sheets.googleapis.com/$discovery/rest?version=v4')
                .then(function () {
                    console.log('GAPI client loaded for API');
                }, function (error) {
                    console.error('Error loading GAPI client for API', error);
                });
        }

        // Fetch and display data from the Google Sheet
        function fetchData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range
            }).then(function (response) {
                var data = response.result.values;
                var dataDiv = document.getElementById('data');
                var html = '<table>';
                for (var i = 0; i < data.length; i++) {
                    html += '<tr>';
                    for (var j = 0; j < data[i].length; j++) {
                        html += '<td>' + data[i][j] + '</td>';
                    }
                    html += '</tr>';
                }
                html += '</table>';
                dataDiv.innerHTML = html;
            }, function (error) {
                console.error('Error fetching data', error);
            });
        }

        // Load the Google Sheets API and fetch data
        gapi.load('client', function () {
            loadClient().then(fetchData);
        });
    </script>
    <script src="https://apis.google.com/js/api.js"></script>
</body>

</html>

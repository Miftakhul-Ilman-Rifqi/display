<!DOCTYPE html>
<html>

<head>
    <title>Google Sheets API Example</title>
</head>

<body>

    <h1>Google Sheets API Example</h1>

    <table id="data-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Age</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        // Client ID and API key from the Developer Console
        var CLIENT_ID = '7564343873-tr5pok8rcth7i9i426it3nr8ba4a7n9n.apps.googleusercontent.com';
        var API_KEY = 'AIzaSyAmT4yC_4qq-C_x11d8wRoA18Hnuj29vhs';

        // Array of API discovery doc URLs for APIs used by the quickstart
        var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

        // Authorization scopes required by the API
        var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

        // Load the API client and sign-in
        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function () {
                // Call the Sheets API
                fetchSheetData();
            });
        }

        function fetchSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1IL6KzH6ULJG0ZvPWq52V90F8nfs2EDDwSb0NVd6Ds2E',
                range: 'Sheet1!A1:G20', // Adjust the range as needed
            }).then(function (response) {
                var values = response.result.values;
                if (values.length > 0) {
                    var tbody = document.querySelector('#data-table tbody');
                    values.forEach(function (row) {
                        var tr = document.createElement('tr');
                        tr.innerHTML = `<td>${row[0]}</td><td>${row[1]}</td>`;
                        tbody.appendChild(tr);
                    });
                } else {
                    console.log('No data found.');
                }
            }, function (response) {
                console.error('Error: ' + response.result.error.message);
            });
        }
    </script>

    <!-- Load the JavaScript client library -->
    <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
        </script>

</body>

</html>
